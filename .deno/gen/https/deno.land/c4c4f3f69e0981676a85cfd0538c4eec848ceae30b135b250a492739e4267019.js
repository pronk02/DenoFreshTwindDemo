let tempDir;
export async function info(specifier, options) {
    const cmd = [
        Deno.execPath(),
        "info",
        "--json", 
    ];
    if (options.importMap !== undefined) {
        cmd.push("--import-map", options.importMap);
    }
    cmd.push(specifier.href);
    if (!tempDir) {
        tempDir = Deno.makeTempDirSync();
    }
    let proc;
    try {
        proc = Deno.run({
            cmd,
            stdout: "piped",
            cwd: tempDir
        });
        const raw = await proc.output();
        const status = await proc.status();
        if (!status.success) {
            throw new Error(`Failed to call 'deno info' on '${specifier.href}'`);
        }
        const txt = new TextDecoder().decode(raw);
        return JSON.parse(txt);
    } finally{
        try {
            proc?.stdout.close();
        } catch (err) {
            if (err instanceof Deno.errors.BadResource) {
            // ignore the error
            } else {
                // deno-lint-ignore no-unsafe-finally
                throw err;
            }
        }
        proc?.close();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvZXNidWlsZF9kZW5vX2xvYWRlckAwLjUuMC9zcmMvZGVuby50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBMaWZ0ZWQgZnJvbSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGVub2xhbmQvZGVub19ncmFwaC84OWFmZmU0M2M5ZDNkNWM5MTY1YzgwODk2ODdjMTA3ZDUzZWQ4ZmUxL2xpYi9tZWRpYV90eXBlLnRzXG5leHBvcnQgdHlwZSBNZWRpYVR5cGUgPVxuICB8IFwiSmF2YVNjcmlwdFwiXG4gIHwgXCJNanNcIlxuICB8IFwiQ2pzXCJcbiAgfCBcIkpTWFwiXG4gIHwgXCJUeXBlU2NyaXB0XCJcbiAgfCBcIk10c1wiXG4gIHwgXCJDdHNcIlxuICB8IFwiRHRzXCJcbiAgfCBcIkRtdHNcIlxuICB8IFwiRGN0c1wiXG4gIHwgXCJUU1hcIlxuICB8IFwiSnNvblwiXG4gIHwgXCJXYXNtXCJcbiAgfCBcIlRzQnVpbGRJbmZvXCJcbiAgfCBcIlNvdXJjZU1hcFwiXG4gIHwgXCJVbmtub3duXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5mb091dHB1dCB7XG4gIHJvb3RzOiBzdHJpbmdbXTtcbiAgbW9kdWxlczogTW9kdWxlRW50cnlbXTtcbiAgcmVkaXJlY3RzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1vZHVsZUVudHJ5IHtcbiAgc3BlY2lmaWVyOiBzdHJpbmc7XG4gIHNpemU6IG51bWJlcjtcbiAgbWVkaWFUeXBlPzogTWVkaWFUeXBlO1xuICBsb2NhbD86IHN0cmluZztcbiAgY2hlY2tzdW0/OiBzdHJpbmc7XG4gIGVtaXQ/OiBzdHJpbmc7XG4gIG1hcD86IHN0cmluZztcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBEZW5vSW5mb09wdGlvbnMge1xuICBpbXBvcnRNYXA/OiBzdHJpbmc7XG59XG5cbmxldCB0ZW1wRGlyOiBudWxsIHwgc3RyaW5nO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5mbyhcbiAgc3BlY2lmaWVyOiBVUkwsXG4gIG9wdGlvbnM6IERlbm9JbmZvT3B0aW9ucyxcbik6IFByb21pc2U8SW5mb091dHB1dD4ge1xuICBjb25zdCBjbWQgPSBbXG4gICAgRGVuby5leGVjUGF0aCgpLFxuICAgIFwiaW5mb1wiLFxuICAgIFwiLS1qc29uXCIsXG4gIF07XG4gIGlmIChvcHRpb25zLmltcG9ydE1hcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY21kLnB1c2goXCItLWltcG9ydC1tYXBcIiwgb3B0aW9ucy5pbXBvcnRNYXApO1xuICB9XG4gIGNtZC5wdXNoKHNwZWNpZmllci5ocmVmKTtcblxuICBpZiAoIXRlbXBEaXIpIHtcbiAgICB0ZW1wRGlyID0gRGVuby5tYWtlVGVtcERpclN5bmMoKTtcbiAgfVxuXG4gIGxldCBwcm9jO1xuXG4gIHRyeSB7XG4gICAgcHJvYyA9IERlbm8ucnVuKHtcbiAgICAgIGNtZCxcbiAgICAgIHN0ZG91dDogXCJwaXBlZFwiLFxuICAgICAgY3dkOiB0ZW1wRGlyLFxuICAgIH0pO1xuICAgIGNvbnN0IHJhdyA9IGF3YWl0IHByb2Mub3V0cHV0KCk7XG4gICAgY29uc3Qgc3RhdHVzID0gYXdhaXQgcHJvYy5zdGF0dXMoKTtcbiAgICBpZiAoIXN0YXR1cy5zdWNjZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBjYWxsICdkZW5vIGluZm8nIG9uICcke3NwZWNpZmllci5ocmVmfSdgKTtcbiAgICB9XG4gICAgY29uc3QgdHh0ID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKHJhdyk7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodHh0KTtcbiAgfSBmaW5hbGx5IHtcbiAgICB0cnkge1xuICAgICAgcHJvYz8uc3Rkb3V0LmNsb3NlKCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoZXJyIGluc3RhbmNlb2YgRGVuby5lcnJvcnMuQmFkUmVzb3VyY2UpIHtcbiAgICAgICAgLy8gaWdub3JlIHRoZSBlcnJvclxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZGVuby1saW50LWlnbm9yZSBuby11bnNhZmUtZmluYWxseVxuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfVxuICAgIHByb2M/LmNsb3NlKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF3Q0EsSUFBSSxPQUFPLEFBQWUsQUFBQztBQUUzQixPQUFPLGVBQWUsSUFBSSxDQUN4QixTQUFjLEVBQ2QsT0FBd0IsRUFDSDtJQUNyQixNQUFNLEdBQUcsR0FBRztRQUNWLElBQUksQ0FBQyxRQUFRLEVBQUU7UUFDZixNQUFNO1FBQ04sUUFBUTtLQUNULEFBQUM7SUFDRixJQUFJLE9BQU8sQ0FBQyxTQUFTLEtBQUssU0FBUyxFQUFFO1FBQ25DLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztLQUM3QztJQUNELEdBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRXpCLElBQUksQ0FBQyxPQUFPLEVBQUU7UUFDWixPQUFPLEdBQUcsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0tBQ2xDO0lBRUQsSUFBSSxJQUFJLEFBQUM7SUFFVCxJQUFJO1FBQ0YsSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7WUFDZCxHQUFHO1lBQ0gsTUFBTSxFQUFFLE9BQU87WUFDZixHQUFHLEVBQUUsT0FBTztTQUNiLENBQUMsQ0FBQztRQUNILE1BQU0sR0FBRyxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sRUFBRSxBQUFDO1FBQ2hDLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sRUFBRSxBQUFDO1FBQ25DLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFO1lBQ25CLE1BQU0sSUFBSSxLQUFLLENBQUMsQ0FBQywrQkFBK0IsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdEU7UUFDRCxNQUFNLEdBQUcsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQUFBQztRQUMxQyxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDeEIsUUFBUztRQUNSLElBQUk7WUFDRixJQUFJLEVBQUUsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQ3RCLENBQUMsT0FBTyxHQUFHLEVBQUU7WUFDWixJQUFJLEdBQUcsWUFBWSxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRTtZQUMxQyxtQkFBbUI7YUFDcEIsTUFBTTtnQkFDTCxxQ0FBcUM7Z0JBQ3JDLE1BQU0sR0FBRyxDQUFDO2FBQ1g7U0FDRjtRQUNELElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQztLQUNmO0NBQ0YifQ==